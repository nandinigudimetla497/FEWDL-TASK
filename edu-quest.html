<!--
EduQuest - Single-file website
Open this file in a browser (double-click) to run the app. No build step required.
Contains: React + Babel (UMD), Tailwind via CDN, localStorage persistence.
-->

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EduQuest — Single File</title>
    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React, ReactDOM (UMD) and Babel for JSX in the browser -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>html,body,#root{height:100%}</style>
  </head>
  <body class="bg-slate-50">
    <div id="root" class="min-h-screen p-6"></div>

    <script type="text/babel">
      const { useState, useEffect, useMemo } = React

      // default lessons (same as your repo)
      const lessonsData = [
        { id: 'html-basics', title: 'HTML Basics', category: 'Web', duration: '30m', description: 'Intro to HTML tags, structure, semantic elements.', content: '<p>Lesson content goes here.</p>' },
        { id: 'css-basics', title: 'CSS Basics', category: 'Web', duration: '40m', description: 'Styling, selectors, box model.', content: '<p>Lesson content goes here.</p>' },
        { id: 'react-intro', title: 'Intro to React', category: 'Frontend', duration: '50m', description: 'Components, props, state.', content: '<p>Lesson content goes here.</p>' }
      ]

      // Utility: read/write progress
      const PROGRESS_KEY = 'eduquest_progress'
      function loadProgress(){
        try{ return JSON.parse(localStorage.getItem(PROGRESS_KEY) || '{}') }
        catch(e){ return {} }
      }
      function saveProgress(obj){ localStorage.setItem(PROGRESS_KEY, JSON.stringify(obj)) }

      function App(){
        const [lessons, setLessons] = useState([])

        useEffect(()=>{
          const stored = loadProgress()
          const merged = lessonsData.map(l => ({ ...l, completed: !!stored[l.id] }))
          setLessons(merged)
        },[])

        const toggleComplete = (id) => {
          setLessons(prev=>{
            const next = prev.map(l=> l.id===id ? { ...l, completed: !l.completed } : l)
            const progress = {}
            next.forEach(x=>{ if(x.completed) progress[x.id] = true })
            saveProgress(progress)
            return next
          })
        }

        return (
          <div className="max-w-6xl mx-auto">
            <header className="mb-6">
              <h1 className="text-3xl font-bold">EduQuest</h1>
              <p className="text-sm text-slate-600">Self-paced learning — track progress, earn badges.</p>
            </header>

            <main>
              <Dashboard lessons={lessons} onToggleComplete={toggleComplete} />
            </main>

            <footer className="mt-8 text-xs text-slate-500">Open-source single-file demo • Progress stored in localStorage</footer>
          </div>
        )
      }

      function Dashboard({ lessons, onToggleComplete }){
        const [filter, setFilter] = useState('All')
        const categories = useMemo(()=> ['All', ...Array.from(new Set(lessons.map(l=>l.category)))] , [lessons])
        const filtered = lessons.filter(l => filter === 'All' ? true : l.category === filter)
        const completedCount = lessons.filter(l => l.completed).length
        const total = lessons.length

        return (
          <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <section className="col-span-2">
              <div className="flex items-center justify-between mb-4">
                <h2 className="text-xl font-semibold">Lessons</h2>
                <div>
                  <label className="mr-2 text-sm">Category:</label>
                  <select value={filter} onChange={e=>setFilter(e.target.value)} className="border rounded p-1">
                    {categories.map(c=> <option key={c} value={c}>{c}</option>)}
                  </select>
                </div>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                {filtered.map(l=> (
                  <LessonCard key={l.id} lesson={l} onToggle={()=> onToggleComplete(l.id)} />
                ))}
              </div>
            </section>

            <aside className="bg-white p-4 rounded shadow">
              <h3 className="font-semibold mb-2">Your Progress</h3>
              <ProgressChart completed={completedCount} total={total} />
              <p className="text-sm text-slate-600 mt-2">{completedCount} of {total} lessons completed</p>

              <div className="mt-4">
                <h4 className="font-medium">Milestones</h4>
                <ul className="text-sm mt-2 space-y-2">
                  <li>{completedCount >= 1 ? 'Started' : '— Start your first lesson'}</li>
                  <li>{completedCount >= Math.ceil(total * 0.5) ? 'Halfway there' : `— Complete ${Math.ceil(total * 0.5) - completedCount} more to reach halfway`}</li>
                  <li>{completedCount === total && total > 0 ? 'Course complete!' : '— Finish all lessons to earn certificate'}</li>
                </ul>

                <div className="mt-4">
                  <button className="px-3 py-1 rounded bg-slate-100" onClick={()=>{ localStorage.removeItem(PROGRESS_KEY); window.location.reload() }}>Reset progress</button>
                </div>
              </div>
            </aside>
          </div>
        )
      }

      function LessonCard({ lesson, onToggle }){
        return (
          <article className="bg-white p-4 rounded shadow">
            <div className="flex items-start justify-between">
              <div>
                <h4 className="font-semibold">{lesson.title}</h4>
                <p className="text-xs text-slate-500">{lesson.category} • {lesson.duration}</p>
                <p className="mt-2 text-sm text-slate-700">{lesson.description}</p>
              </div>
              <div className="text-right">
                <button onClick={onToggle} className={`px-3 py-1 rounded ${lesson.completed ? 'bg-green-100 text-green-700' : 'bg-slate-100 text-slate-700'}`}>
                  {lesson.completed ? 'Completed' : 'Mark done'}
                </button>
              </div>
            </div>
          </article>
        )
      }

      // Simple pie chart using SVG – no external libraries
      function ProgressChart({ completed, total }){
        const remaining = Math.max(0, total - completed)
        const angle = total === 0 ? 0 : (completed / total) * 360
        const radius = 40
        const cx = 60, cy = 60
        const r = radius
        const circumference = 2 * Math.PI * r
        const dash = total === 0 ? '0 0' : `${(completed/total)*circumference} ${circumference}`

        // compute arc path for label
        const percent = total === 0 ? 0 : Math.round((completed/total) * 100)

        return (
          <div style={{ width: '100%', height: 160 }} className="flex items-center justify-center">
            <svg width="120" height="120" viewBox="0 0 120 120">
              <defs>
                <linearGradient id="g1" x1="0" x2="1">
                  <stop offset="0%" stopColor="#34d399" />
                  <stop offset="100%" stopColor="#10b981" />
                </linearGradient>
              </defs>

              {/* background circle */}
              <circle cx={cx} cy={cy} r={r} fill="transparent" stroke="#e6e9ee" strokeWidth="16" />

              {/* foreground using stroke-dasharray */}
              <circle cx={cx} cy={cy} r={r} fill="transparent" stroke="url(#g1)" strokeWidth="16"
                strokeLinecap="round"
                transform={`rotate(-90 ${cx} ${cy})`}
                style={{ strokeDasharray: dash, transition: 'stroke-dasharray 300ms ease' }}
              />

              <text x={cx} y={cy} textAnchor="middle" dominantBaseline="central" fontSize="18" fontWeight="600">{percent}%</text>
            </svg>
          </div>
        )
      }

      // ModalQuiz placeholder
      function ModalQuiz(){
        return (
          <div className="p-4">Mini-quiz placeholder — implement question set and scoring here.</div>
        )
      }

      ReactDOM.createRoot(document.getElementById('root')).render(<App />)
    </script>
  </body>
</html>